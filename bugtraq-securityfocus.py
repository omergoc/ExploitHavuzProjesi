import requests
import pymongo

class bugtraq_securityfocus:
    def __init__(self):
        self.client = pymongo.MongoClient('mongodb://localhost:27017/')
        self.db = self.client['THT']
        self.col = self.db['bugtraq_securityfocus']

    def Script(self):
        resp = requests.get(
            'https://bugtraq-api.securityfocus.com/email/list?sortField=sent_date&sortOrder=DESC&pageNumber=1&pageSize=30',
            headers={'User-Agent': 'Mozilla/5.0', 'X-Requested-With': 'XMLHttpRequest', 'Accept': 'application/json, text/javascript, */*; q=0.01'}
        )

        for exploit in resp.json()["emails"]:
            exploit_id = exploit["id"]
            if len(list(self.col.find({'id': exploit_id}))) == 0:
                self.col.insert_one(exploit)


if __name__ == '__main__':
    App = bugtraq_securityfocus()
    print("bugtraq-securityfocus-lab Exploit Bilgileri Çekiliyor.")
    App.Script()
    print("İşlem Tamamlandı.")